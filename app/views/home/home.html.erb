
<%# render :partial => 'general_home' %>
<% if logged_in? %>
<h3>Welcome back, <%= current_user.proper_name %></h3>

<!-- <p>Below is information on your projects and incomplete tasks for those projects:</p> -->
<% else %>

<%= render :partial => 'general_home' %>
<%end%>


<% if logged_in? && (current_user.role == "admin" || current_user.role == "manager" || current_user.role == "shipper" )%>
<%= render :partial => 'reorder_list' %>

<%= render :partial => 'pending_orders' %>
<%end%>


<% if logged_in? && (current_user.role == "admin") %>

<h5> Summary </h5>
<table class="table table-striped">
	<thead>
		<tr>
			<th width="300"> Metric </th>
			<th width="100"> Measure </th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td> Total Sales </td>
			<td> <% @total = 0 %>
				<% Order.all.each do |o| @total += o.grand_total %>
				<%end%>
				<%= number_to_currency @total %>
			</td>
		</tr>
		<tr>
			<td> Total number of employees </td>
			<td>
				<% @total = 0 %>
				<% User.employees.all.each do |o| @total += 1 %>
				<%end%>
				<%= @total %>

			</td>
		</tr>
		<tr> <td> Total number of customers </td>
			<td> 
				<% @total = 0 %>
				<% User.customers.all.each do |o| @total += 1 %>
				<%end%>
				<%= @total %>

			</td>
		</tr>
		<tr>
			<td> Items to be reordered </td>
			<td> <% @total = 0 %>
				<% Item.need_reorder.each do |o| @total += 1 %>
				<%end%>
				<%= @total %>
			</td>
		</tr>
		<tr>
			<td> Unshipped Orders </td>
			<td> <% @total = 0 %>
				<% Order.not_shipped.each do |o| @total += 1 %>
				<%end%>
				<%= @total %>
				<%= link_to 'Go', orders_path, :class => 'button alert radius' %>
			</td>
		</tr>


	</tbody>
</table>


  <div class="row">
    <div class="large-4 small-4 columns">
      <ul data-pie-id="pie">
      	<% @boards = 0 %> <% @supplies = 0 %> <% @clocks = 0 %> <% @pieces = 0 %>
				<% Item.for_category('boards').each do |b| @boards += 1 %> <%end%>
				<% Item.for_category('supplies').each do |s| @supplies += 1 %> <%end%>
				<% Item.for_category('clocks').each do |c| @clocks += 1 %> <%end%>
				<% Item.for_category('pieces').each do |p| @pieces += 1 %>
				<%end%>
        <li data-value=<%= @boards %> >Boards</li>
        <li data-value=<%= @supplies %> >Supplies</li>
        <li data-value=<%= @clocks %> >Clocks</li>
        <li data-value=<%= @pieces %> >Pieces</li>
        <!-- <li data-value="50">Shetland Pony (50)</li> -->
      </ul>
    </div>
    <div class="large-8 small-8 columns">
      <div id="pie"></div>
    </div>
  </div>



  <div class="row">
    <div class="large-4 small-4 columns">
      <ul data-line-id="line">
      	<% @jan = 0 %> <% @feb = 0 %> <% @mar = 0 %> <% @april = 0 %>
      	<% @may = 0 %> <% @june = 0 %> <% @july = 0 %> <% @aug = 0 %>
      	<% @sept = 0 %> <% @oct = 0 %> <% @nov = 0 %> <% @dec = 0 %>
      	<% Order.for_month(1).each do |j| @jan += j %> <% end %>
        <li data-y= <%= @jan %> data-x="0">January</li>
        <li data-y="10" data-x="10">Bison</li>
        <li data-y="20" data-x="20">Bison</li>
        <li data-y="30" data-x="30">Bison</li>
        <li data-y="35" data-x="40">Bison</li>
        <li data-y="50" data-x="200">Bison</li>
      </ul>
    </div>
    <div class="large-8 small-8 columns">
      <div id="line" style="height: 450px;"></div>
    </div>
  </div>


  <script>
    $(window).load(function() {
      Pizza.init();
      $(document).foundation();
    });
  </script>

<% end %>

